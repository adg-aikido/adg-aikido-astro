---
/**
 * InstructorList Component
 * 
 * Displays instructor information with 3 variants:
 * - list: Simple list with names and ranks
 * - cards: Card-based layout with avatars and details
 * - legend: Legend-style with rank badges
 */

import type { Instructor } from '../types/instructors';

export interface Props {
  variant?: 'list' | 'cards' | 'legend';
  instructors: Instructor[];
  contactEmail?: string;
  contactDescription?: string;
  showContact?: boolean;
}

const { 
  variant = 'list',
  instructors,
  contactEmail = 'radet@adg-aikido.se',
  contactDescription = 'Du kan kontakta instruktÃ¶rerna pÃ¥',
  showContact = true
} = Astro.props;

// Color mapping for rank badges
const getRankColor = (rank: string) => {
  const rankNumber = parseInt(rank);
  if (rankNumber >= 7) return 'primary';
  if (rankNumber >= 6) return 'secondary';
  if (rankNumber >= 5) return 'accent';
  return 'neutral';
};
---

{variant === 'list' && (
  <div>
    <ul class="mb-5 list-none space-y-1">
      {instructors.map((instructor) => (
        <li>
          {instructor.name}, {instructor.rank} ({instructor.groups.join(", ")})
        </li>
      ))}
    </ul>
    {showContact && (
      <p>
        {contactDescription}
        {' '}
        <a href={`mailto:${contactEmail}`} class="link link-primary">
          {contactEmail}
        </a>
      </p>
    )}
  </div>
)}

{variant === 'cards' && (
  <div>
    <div class="space-y-3">
      {instructors.map((instructor) => {
        const rankColor = getRankColor(instructor.rank);
        const rankNumber = instructor.rank.split(' ')[0];
        
        return (
          <div class="flex items-center gap-3 p-3 bg-base-200 rounded-lg shadow-sm">
            <div class="avatar placeholder">
              <div class={`bg-${rankColor} text-${rankColor}-content rounded-full w-12`}>
                <span class="text-xl">{rankNumber}</span>
              </div>
            </div>
            <div class="flex-1">
              <p class="font-semibold">{instructor.name}</p>
              <p class="text-sm text-base-content/70">{instructor.rank} ({instructor.groups.join(", ")})</p>
            </div>
          </div>
        );
      })}
    </div>
    {showContact && (
      <div class="card-actions justify-end mt-4">
        <a href={`mailto:${contactEmail}`} class="btn btn-primary btn-sm">
          ðŸ“§ Kontakta instruktÃ¶rerna
        </a>
      </div>
    )}
  </div>
)}

{variant === 'legend' && (
  <div>
    <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {instructors.map((instructor) => {
        const rankColor = getRankColor(instructor.rank);
        
        return (
          <div class="card card-border bg-base-100 shadow">
            <div class="card-body p-4">
              <div class="flex items-start gap-3">
                <div class={`badge badge-${rankColor} badge-lg shrink-0`}>
                  {instructor.rank}
                </div>
                <div class="flex-1 min-w-0">
                  <h3 class="font-bold truncate">{instructor.name}</h3>
                  <p class="text-sm text-base-content/70">
                    {instructor.groups.join(", ")}
                  </p>
                </div>
              </div>
            </div>
          </div>
        );
      })}
    </div>
    {showContact && (
      <div class="mt-6 text-center">
        <p class="text-sm mb-2">{contactDescription}</p>
        <a href={`mailto:${contactEmail}`} class="btn btn-primary btn-sm">
          ðŸ“§ {contactEmail}
        </a>
      </div>
    )}
  </div>
)}
