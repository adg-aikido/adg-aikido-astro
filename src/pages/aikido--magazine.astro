---
import Layout from "../layouts/Layout.astro";
import SectionHeading from "../components/common/SectionHeading.astro";
import { getCollection } from "astro:content";

const sections = await getCollection("aikido-sections");
const orderedSections = sections.sort((a, b) => {
  const order = [
    "aikido",
    "historia",
    "om-traningen",
    "taijutsu",
    "aikiken",
    "aikijo",
  ];
  const indexA = order.indexOf(a.data.id);
  const indexB = order.indexOf(b.data.id);
  if (indexA === -1) return 1;
  if (indexB === -1) return -1;
  return indexA - indexB;
});

const renderedSections = await Promise.all(
  orderedSections.map(async (section) => ({
    ...section,
    Content: (await section.render()).Content,
  })),
);

// Suggested pull quotes to add visual interest
const pullQuotes = {
  aikido: "En väg till harmoni genom rörelse",
  historia: "Från samurajtradition till modern kampkonst",
  "om-traningen": "Varje träningspass är en resa i självkännedom",
};
---

<Layout
  title="Vad är aikido? - Aikido Dojo Gamlestaden"
  description="Aikido är en modern kampkonst utvecklad från urgamla tekniker. Lär dig mer om aikidons historia, träning och filosofi."
>
  <!-- Hero Section with Gradient -->
  <div class="relative overflow-hidden bg-linear-to-br from-primary/20 via-base-100 to-secondary/20">
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_30%_20%,rgba(120,119,198,0.1),transparent_50%)]"></div>
    <div class="container relative mx-auto max-w-5xl px-4 py-24 text-center">
      <div class="badge badge-primary badge-lg mb-6">合気道</div>
      <h1 class="mb-6 text-6xl font-bold tracking-tight text-base-content md:text-7xl">
        Aikido
      </h1>
      <p class="mx-auto max-w-2xl text-xl text-base-content/80">
        Upptäck konsten att förvandla konflikt till harmoni
      </p>
      <div class="mt-12 flex justify-center gap-4">
        <a href="#historia" class="btn btn-primary btn-lg gap-2">
          Läs mer
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </a>
      </div>
    </div>
  </div>

  <!-- Magazine-style Content Grid -->
  <div class="container mx-auto max-w-6xl px-4 py-16">
    {
      renderedSections.map((section, index: number) => {
        const isEven = index % 2 === 0;
        const quote = pullQuotes[section.data.id as keyof typeof pullQuotes];
        
        return (
          <article 
            id={section.data.id} 
            class="scroll-mt-24 mb-24"
          >
            <div class={`grid gap-12 lg:grid-cols-12 ${isEven ? '' : 'lg:grid-flow-dense'}`}>
              {/* Text Content */}
              <div class={`lg:col-span-7 ${isEven ? '' : 'lg:col-start-6'}`}>
                <div class="mb-4">
                  <span class="text-sm font-semibold uppercase tracking-widest text-primary">
                    {String(index + 1).padStart(2, '0')}
                  </span>
                </div>
                <SectionHeading level="h2" class="mb-6 text-4xl font-bold">
                  {section.data.title}
                </SectionHeading>
                <div class="prose prose-lg max-w-none text-base-content/90">
                  <section.Content />
                </div>
                
                {/* Navigation Links */}
                {index === 0 && (
                  <div class="mt-8 flex flex-wrap gap-2">
                    {orderedSections.slice(1).map((s) => (
                      <a href={`#${s.data.id}`} class="btn btn-outline btn-sm">
                        {s.data.title}
                      </a>
                    ))}
                  </div>
                )}
              </div>

              {/* Visual Accent Card */}
              <div class={`lg:col-span-5 ${isEven ? 'lg:col-start-8' : 'lg:col-start-1 lg:row-start-1'}`}>
                <div class="sticky top-24">
                  {quote && (
                    <div class="card bg-linear-to-br from-primary/10 to-secondary/10 shadow-xl">
                      <div class="card-body">
                        <div class="text-6xl text-primary/20">"</div>
                        <blockquote class="text-2xl font-light italic leading-relaxed text-base-content">
                          {quote}
                        </blockquote>
                        <div class="mt-4 h-1 w-16 bg-primary"></div>
                      </div>
                    </div>
                  )}
                  {/* Suggestion: Add technique images here */}
                  {section.data.id === 'taijutsu' && (
                    <div class="mt-6 rounded-box bg-base-200 p-6 text-sm">
                      <div class="flex items-start gap-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-info" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <p class="text-base-content/70">
                          <strong>Förslag:</strong> Lägg till bilder eller videoklipp som demonstrerar grundläggande tekniker
                        </p>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            </div>

            {/* Section Divider */}
            {index < renderedSections.length - 1 && (
              <div class="mt-24 flex items-center gap-4">
                <div class="h-px flex-1 bg-linear-to-r from-transparent via-base-content/20 to-transparent"></div>
                <div class="text-base-content/30">✦</div>
                <div class="h-px flex-1 bg-linear-to-r from-transparent via-base-content/20 to-transparent"></div>
              </div>
            )}
          </article>
        );
      })
    }
  </div>

  <!-- Closing CTA Section -->
  <div class="bg-linear-to-br from-primary/10 to-secondary/10">
    <div class="container mx-auto max-w-4xl px-4 py-20 text-center">
      <h2 class="mb-4 text-3xl font-bold">Redo att börja din aikido-resa?</h2>
      <p class="mb-8 text-lg text-base-content/80">
        Kom och prova på en träning helt kostnadsfritt
      </p>
      <div class="flex flex-wrap justify-center gap-4">
        <a href="/schema" class="btn btn-primary btn-lg">Se träningsschema</a>
        <a href="/kontakt" class="btn btn-outline btn-lg">Kontakta oss</a>
      </div>
    </div>
  </div>
</Layout>

<!-- Suggested additional content:
  1. Add hero images for each major section (aikido, historia, om-traningen)
  2. Include technique demonstration videos or GIFs
  3. Add instructor quotes or testimonials
  4. Include historical photos from aikido's development
  5. Add infographic showing aikido techniques breakdown
-->
