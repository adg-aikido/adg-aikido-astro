---
import Layout from "../layouts/Layout.astro";
import MediaSection from "../components/common/MediaSection.astro";
import MasonryMediaCard from "../components/common/MasonryMediaCard.astro";
import CircleArrowIcon from "../assets/circle-arrow-right-icon-8e72d6.svg";
import { getCollection } from 'astro:content';

const mediaSections = await getCollection('media');
// Sort by a predefined order if needed, or use alphabetically
const orderedSections = mediaSections.sort((a, b) => {
  const order = ['nyhetsbrev', 'traningsvideor', 'dokument', 'affischer', 'foreningsdokument', 'videogalleri'];
  return order.indexOf(a.data.id) - order.indexOf(b.data.id);
});

const tableOfContents = [
  { id: "nyhetsbrev", label: "Nyhetsbrev" },
  { id: "traningsvideor", label: "Träningsvideor" },
  { id: "dokument", label: "Dokument" },
  { id: "affischer", label: "Affischer" },
  { id: "foreningsdokument", label: "Föreningsdokument" },
  { id: "videogalleri", label: "Videogalleri" },
];
---

<Layout
  title="Media - Aikido Dojo Gamlestaden"
  description="Träningsvideor, dokument, affischer och annat material från Aikido Dojo Gamlestaden."
>
  <main class="container mx-auto max-w-6xl px-4 py-2 sm:px-6 lg:px-8">
    <div class="pb-8">
      <!-- Table of Contents -->
      <nav class="mb-8 p-5 bg-base-200/30 border-l-2 border-primary/40">
        <h2 class="text-sm font-medium tracking-wider uppercase text-base-content/60 mb-4">Innehåll</h2>
        <ul class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-3">
          {tableOfContents.map((item) => (
            <li class="flex items-center">
              <div class="w-4 h-4 mr-3 flex-shrink-0 text-primary/60">
                <CircleArrowIcon />
              </div>
              <a href={`#${item.id}`} class="hover:text-primary transition-colors">{item.label}</a>
            </li>
          ))}
        </ul>
      </nav>

      <ul>
        {orderedSections.map((section) => (
          <MediaSection 
            title={section.data.title} 
            subtitle={section.data.subtitle}
            id={section.data.id}
            gridCols={section.data.gridCols}
          >
            {section.data.items.map((card) => (
              <MasonryMediaCard
                href={card.href}
                title={card.title}
                category={section.data.title}
                thumbnail={card.thumbnail}
                thumbnailAlt={card.thumbnailAlt}
                tags={card.tags}
                isYouTube={card.isYouTube}
              />
            ))}
          </MediaSection>
        ))}
      </ul>
    </div>
  </main>
</Layout>
